<View bind:promise bind:interviewSteps>
	<span slot='loaded'>
		{#each interviewSteps as question}
			<!-- <Json bind:json=question name="{question.questionID}.json" /> -->
			<Question bind:question />
		{/each}
		<Json bind:json=interviewSteps name='interview.json' />
		<Json bind:json=info name='info.json' />
	</span>
</View>

<style>
  body { 
    padding: 0;
    margin: 0;
  }
</style>

<script>

	let formatQuestion = q => { 
		switch(q.presentationType) { 
			case 'CHECK_BOX': 
				q.answerElements.forEach(a => a.checked = false);
				break; 
		}
	}; 

	let transformData = (values) => {
		let [interview,info] = values;
		return { 
			info, 
			interviewSteps: interview.questionElements.map(q => {
				q.presentationType = q.answerElements[0].presentationType;
				q.value = '';
				console.log(q.presentationType);
				return q;
			})
		}
	}

	export default {
		data() { 
			return {
				interviewSteps: []
			}
		},
		oncreate() { 
			let getInterview = fetch(`/data/interview.json`)
			let getInfo = fetch(`/data/taskInfo.json`)
			this.set({
				promise: Promise.all([getInterview, getInfo])
					.then(values => Promise.all(values.map(v => v.json())))
					.then()
					.then(data => {
						this.set(transformData(data));
					})
					.catch(errors => {
						console.log(errors);
					})
			})
		}, 
		components: {
			Question: './Components/Question.html', 
			Json: './Components/Json.html', 
			View: './Components/View.html'
		}
	};
</script>